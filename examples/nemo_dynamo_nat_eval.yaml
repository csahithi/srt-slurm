# NeMo Agent Toolkit + Dynamo benchmark (srtslurm)
# Uses the standard Dynamo frontend. Prefix hints are enabled in the NAT eval config.
name: "nemo-dynamo-nat-eval"

model:
  # Local model path or alias from srtslurm.yaml
  path: "/path/to/models/Llama-3.3-70B-Instruct"
  # Container alias from srtslurm.yaml or a direct image path
  container: "dynamo-sglang-runtime"
  precision: "bf16"

resources:
  # Unified (aggregated) mode
  gpu_type: "h100"
  gpus_per_node: 4
  agg_nodes: 1
  agg_workers: 1

frontend:
  type: dynamo
  enable_multiple_frontends: false
  args:
    model-name: "llama-3.3-70b"
    model-path: "/model"

backend:
  type: sglang
  sglang_config:
    aggregated:
      tp: 4
      served-model-name: "llama-3.3-70b"
      trust-remote-code: true
      mem-fraction-static: 0.9
      enable-metrics: true

dynamo:
  # Dynamo runtime is already in the container image
  install: false

infra:
  etcd_nats_dedicated_node: false

benchmark:
  type: custom
  # Container must include `nvidia-nat` and dependencies
  container_image: "nemo-nat"
  command: |
    bash -lc '
      cd /workspace/NeMo-Agent-Toolkit
      nat eval --config_file examples/dynamo_integration/react_benchmark_agent/configs/eval_config_no_rethinking_minimal_test_srtslurm.yml
    '

container_mounts:
  # Mount the NeMo-Agent-Toolkit repo so nat eval can access configs/data
  "/path/to/NeMo-Agent-Toolkit": "/workspace/NeMo-Agent-Toolkit"
